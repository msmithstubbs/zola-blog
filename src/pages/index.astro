---
import Base from '../layouts/Base.astro';
const postFiles = import.meta.glob('./**/*.md', { eager: true });
const posts = Object.entries(postFiles)
  .filter(([k]) => !k.includes('index'))
  .map(([_, mod]) => ({ ...mod.frontmatter, url: mod.url, Content: mod.default }))
  .sort((a, b) => new Date(b.date) - new Date(a.date))
  .slice(0, 3);
---
<Base>
  <article>
    <h1>Notes</h1>
    <p class="subtitle">by Matt Stubbs</p>
    {posts.map(post => (
      <section>
        <h2><a href={post.url}>{post.title}</a></h2>
        <h3>{new Date(post.date).toLocaleDateString('en-US', {year:'numeric', month:'long', day:'numeric'})}</h3>
        <post.Content />
      </section>
    ))}
  </article>
  <div>
    <p><a href="/notes">All notes &rarr;</a></p>
  </div>
</Base>
